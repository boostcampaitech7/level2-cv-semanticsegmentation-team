## Train (ν•™μµ) μ„¤μ •

### 1. WandB μ„¤μ •
WandBλ¥Ό ν†µν•΄ ν•™μµ λ΅κ·Έλ¥Ό μ¶”μ ν•λ ¤λ©΄ `config.yaml`μ—μ„ λ‹¤μ ν•­λ©μ„ μμ •ν•μ„Έμ”:

### 2. λ¨λΈ μ„¤μ •
μ‚¬μ „ ν•™μµλ λ¨λΈμ„ μ‚¬μ©ν•λ ¤λ©΄ λ‹¤μμ„ μ„¤μ •ν•©λ‹λ‹¤:
```yaml
pretrained: false # μ‚¬μ „ ν•™μµλ λ¨λΈ μ‚¬μ© μ—¬λ¶€ (True/False) 
pretrained_dir: "/path/to/best_model.pt" # μ‚¬μ „ ν•™μµλ λ¨λΈ μ²΄ν¬ν¬μΈνΈ κ²½λ΅ (ν•„μ” μ‹ μμ •) 
device: "cuda" # μ‚¬μ©ν•  λ””λ°”μ΄μ¤ (cuda λλ” cpu)
```
- **`pretrained`**: `true`λ΅ μ„¤μ •ν•λ©΄ μ‚¬μ „ ν•™μµλ λ¨λΈμ„ μ‚¬μ©ν•©λ‹λ‹¤.
- **`pretrained_dir`**: μ‚¬μ „ ν•™μµλ λ¨λΈ κ²½λ΅λ¥Ό μ •ν™•ν μ…λ ¥ν•μ„Έμ”.
- **`device`**: GPUλ¥Ό μ‚¬μ©ν•  κ²½μ° `cuda`, μ•„λ‹λ©΄ `cpu`λ΅ μ„¤μ •ν•©λ‹λ‹¤.

### 3. ν•™μµ ν•μ΄νΌνλΌλ―Έν„° μ„¤μ •
μμ‹ μ μ‹μ¤ν…μ— λ§κ² λ°°μΉ ν¬κΈ°, ν•™μµλ¥ , μ—ν¬ν¬ μ λ“±μ„ μ΅°μ •ν•©λ‹λ‹¤:
```yaml
batch_size: 16 
learning_rate: 0.0001 
num_epochs: 100 
val_every: 5 
random_seed: 42
```

### 5. λ°μ΄ν„° λ° κ²½λ΅ μ„¤μ •
μμ‹ μ λ°μ΄ν„° λ° μ €μ¥ κ²½λ΅λ¥Ό μ§€μ •ν•©λ‹λ‹¤:
```yaml
data_root: "/data/your_path/data" 
image_root: "/data/your_path/data/train/DCM" 
label_root: "/data/your_path/kfold_splits/" 
saved_dir: "/data/your_path/saved_model"
```
- **`data_root`**: λ°μ΄ν„°μ…‹μ λ£¨νΈ λ””λ ‰ν† λ¦¬ κ²½λ΅.
- **`image_root`**: ν•™μµ μ΄λ―Έμ§€λ“¤μ΄ μ €μ¥λ κ²½λ΅.
- **`label_root`**: KFold JSON νμΌλ“¤μ΄ μ €μ¥λ κ²½λ΅.
- **`saved_dir`**: λ¨λΈ μ²΄ν¬ν¬μΈνΈμ™€ κ²°κ³Όλ¥Ό μ €μ¥ν•  λ””λ ‰ν† λ¦¬.

---

## Inference (μ¶”λ΅ ) μ„¤μ •


## **Inference (μ¶”λ΅ ) μ„¤μ •**

μ¶”λ΅ μ„ μ‹μ‘ν•κΈ° μ „μ— **`config.yaml`**μ—μ„ λ‹¤μ ν•­λ©λ“¤μ„ μμ •ν•μ„Έμ”. μ΄ μ„Ήμ…μ—μ„λ” μ¶”λ΅  μ‹ ν•„μ”ν• μ„¤μ •μ„ μ¤‘μ μ μΌλ΅ μ„¤λ…ν•©λ‹λ‹¤.

---

### **1. λ¨λΈ μ²΄ν¬ν¬μΈνΈ μ„¤μ •**
μ¶”λ΅ μ— μ‚¬μ©ν•  μ‚¬μ „ ν•™μµλ λ¨λΈ μ²΄ν¬ν¬μΈνΈλ¥Ό μ§€μ •ν•©λ‹λ‹¤.
```yaml
pretrained: true                      # μ¶”λ΅  μ‹ μ‚¬μ „ ν•™μµλ λ¨λΈ μ‚¬μ© (Trueλ΅ μ„¤μ •)
pretrained_dir: "/path/to/best_model.pth"  # μ‚¬μ „ ν•™μµλ λ¨λΈ μ²΄ν¬ν¬μΈνΈ κ²½λ΅
device: "cuda"                        # μ‚¬μ©ν•  λ””λ°”μ΄μ¤ (cuda λλ” cpu)
```


### **2. ν…μ¤νΈ λ°μ΄ν„° κ²½λ΅ μ„¤μ •**
ν…μ¤νΈ μ΄λ―Έμ§€κ°€ μ €μ¥λ κ²½λ΅μ™€ μ¶”λ΅  κ²°κ³Όλ¥Ό μ €μ¥ν•  κ²½λ΅λ¥Ό μ§€μ •ν•©λ‹λ‹¤.

```yaml
test_image_root: "/data/your_path/data/test/DCM"
saved_dir: "/data/your_path/saved_model"
```
test_image_root: ν…μ¤νΈν•  μ΄λ―Έμ§€λ“¤μ΄ μ €μ¥λ λ””λ ‰ν† λ¦¬ κ²½λ΅λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
saved_dir: μ¶”λ΅  κ²°κ³Όλ¥Ό μ €μ¥ν•  λ””λ ‰ν† λ¦¬ κ²½λ΅λ¥Ό μ§€μ •ν•©λ‹λ‹¤. μ¶”λ΅ λ λ§μ¤ν¬ μ΄λ―Έμ§€ λ° CSV νμΌμ΄ μ΄ κ²½λ΅μ— μ €μ¥λ©λ‹λ‹¤.


### **3,μ¶”λ΅  ν•μ΄νΌνλΌλ―Έν„°**
μ¶”λ΅  μ‹, μμΈ΅λ λ§μ¤ν¬μ— μ μ©ν•  μ„κ³„κ°’(threshold)μ„ μ΅°μ •ν•  μ μμµλ‹λ‹¤. inference.py λ‚΄λ¶€μ—μ„ μ„¤μ •ν•©λ‹λ‹¤.

```python
μ½”λ“ λ³µμ‚¬
threshold = 0.5  # λ§μ¤ν¬ μƒμ„± μ‹ μ‚¬μ©ν•  μ„κ³„κ°’
threshold: λ¨λΈμ μ¶λ ¥κ°’μ„ 0.5 μ΄μƒμΌλ΅ μ„¤μ •λ ν”½μ…€μ„ λ§μ¤ν¬λ΅ μΈμ‹ν•©λ‹λ‹¤. ν•„μ”μ— λ”°λΌ μ΅°μ • κ°€λ¥ν•©λ‹λ‹¤.
```

### **4. μ¶”λ΅  μ‹¤ν–‰ λ°©λ²•**
μ¶”λ΅ μ„ μ„ν•΄ inference.py μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•μ„Έμ”:

```bash
python inference.py
```

μ¶”λ΅  κ²°κ³Όλ” config.yamlμ— μ§€μ •ν• saved_dir κ²½λ΅μ— CSV νμΌκ³Ό λ§μ¤ν¬ μ΄λ―Έμ§€λ΅ μ €μ¥λ©λ‹λ‹¤.


### **5. Inference μ„¤μ • μ”μ•½**
**pretrained**λ¥Ό trueλ΅ μ„¤μ •ν•μ—¬ μ²΄ν¬ν¬μΈνΈλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
**pretrained_dir**μ—μ„ μ‚¬μ „ ν•™μµλ λ¨λΈμ„ λ¶λ¬μµλ‹λ‹¤.
**test_image_root**μ— ν…μ¤νΈ μ΄λ―Έμ§€ κ²½λ΅λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
**saved_dir**μ— μ¶”λ΅  κ²°κ³Όλ¥Ό μ €μ¥ν•©λ‹λ‹¤.
ν•„μ”ν• κ²½μ°, threshold κ°’μ„ inference.pyμ—μ„ μ΅°μ •ν•©λ‹λ‹¤.
μ΄μ  μ‚¬μ©μλ” config.yaml νμΌμ„ μμ •ν•μ—¬ μ†μ‰½κ² μ¶”λ΅ μ„ μν–‰ν•  μ μμµλ‹λ‹¤. π€π